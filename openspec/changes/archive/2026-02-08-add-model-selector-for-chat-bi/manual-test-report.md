# ModelSelector 手动测试报告

## 测试环境

- **浏览器**: Chrome/Edge/Firefox 最新版
- **测试日期**: 2025-02-08
- **测试页面**: ChatAnalysis 页面

## 测试准备

### 前置条件
1. 启动后端服务
2. 启动前端开发服务器: `pnpm -C frontend dev`
3. 访问 ChatAnalysis 页面
4. 准备至少一个已启用的模型配置

---

## 测试用例

### ✅ TC1: 有模型配置的环境下测试选择器功能

**步骤**:
1. 确保系统中存在至少一个已启用的模型配置
2. 访问 ChatAnalysis 页面
3. 观察页面顶部是否显示模型选择器
4. 点击选择器，检查是否显示所有已启用的模型配置
5. 选择一个模型配置
6. 刷新页面
7. 检查选择是否保持

**预期结果**:
- [ ] 选择器正常显示
- [ ] 显示所有已启用的模型配置
- [ ] 选项格式正确：`<配置名称> (N个模型)`
- [ ] 选择后选项高亮显示
- [ ] 刷新页面后选择保持

**实际结果**: _待测试_

**状态**: _待执行_

---

### ✅ TC2: 无模型配置的环境下测试禁用状态

**步骤**:
1. 确保系统中没有已启用的模型配置（禁用所有配置或删除所有配置）
2. 访问 ChatAnalysis 页面
3. 观察选择器状态

**预期结果**:
- [ ] 选择器仍然显示（固定布局）
- [ ] 选择器处于禁用状态（灰色样式）
- [ ] 占位符显示："暂无可用模型，请先添加模型配置"
- [ ] 点击选择器不展开下拉列表

**实际结果**: _待测试_

**状态**: _待执行_

---

### ✅ TC3: localStorage 持久化功能测试

**步骤**:
1. 访问 ChatAnalysis 页面
2. 选择一个模型配置
3. 打开浏览器开发者工具 → Application → Local Storage
4. 检查是否存在 `chat-selected-model-config-id` 键
5. 验证存储的值是否为选中的模型 ID
6. 关闭浏览器
7. 重新打开浏览器并访问 ChatAnalysis 页面
8. 检查选择器是否自动选中之前选择的模型

**预期结果**:
- [ ] localStorage 中存在 `chat-selected-model-config-id` 键
- [ ] 存储的值正确
- [ ] 重新打开浏览器后选择保持

**实际结果**: _待测试_

**状态**: _待执行_

---

### ✅ TC4: 删除选中的模型配置后的行为测试

**步骤**:
1. 访问 ChatAnalysis 页面并选择一个模型配置
2. 在另一个标签页中打开模型配置管理页面
3. 删除刚才选择的模型配置
4. 返回 ChatAnalysis 页面并刷新
5. 观察选择器状态

**预期结果**:
- [ ] localStorage 中的旧选择被清除
- [ ] 选择器自动选中第一个可用的模型配置
- [ ] 如果没有可用模型，显示禁用状态

**实际结果**: _待测试_

**状态**: _待执行_

---

### ✅ TC5: 禁用选中的模型配置后的行为测试

**步骤**:
1. 访问 ChatAnalysis 页面并选择一个模型配置
2. 在另一个标签页中打开模型配置管理页面
3. 禁用刚才选择的模型配置（`is_active` 设为 false）
4. 返回 ChatAnalysis 页面并刷新
5. 观察选择器状态

**预期结果**:
- [ ] 选择器不再显示被禁用的配置
- [ ] 选择器自动选中第一个可用的模型配置
- [ ] 如果没有可用模型，显示禁用状态

**实际结果**: _待测试_

**状态**: _待执行_

---

### ✅ TC6: 多标签页独立性测试

**步骤**:
1. 在浏览器中打开两个 ChatAnalysis 页面标签页
2. 在标签页 A 中选择模型配置 X
3. 在标签页 B 中选择模型配置 Y
4. 刷新标签页 A
5. 检查标签页 A 的选择是否仍为 X

**预期结果**:
- [ ] 两个标签页的选择互不影响
- [ ] 每个标签页独立维护选择状态
- [ ] 刷新标签页 A 后仍保持选择 X

**实际结果**: _待测试_

**状态**: _待执行_

---

### ✅ TC7: 加载状态测试

**步骤**:
1. 打开浏览器开发者工具 → Network 标签
2. 限制网络速度（可选，设为 Slow 3G）
3. 访问 ChatAnalysis 页面
4. 观察选择器加载状态

**预期结果**:
- [ ] 选择器显示 "加载中..." 占位符
- [ ] 选择器显示 loading 动画
- [ ] 数据加载完成后显示正常状态

**实际结果**: _待测试_

**状态**: _待执行_

---

### ✅ TC8: 错误处理测试

**步骤**:
1. 模拟网络错误（断开网络或阻止 API 请求）
2. 访问 ChatAnalysis 页面
3. 观察错误提示

**预期结果**:
- [ ] 显示友好的错误消息
- [ ] 提供"重试"按钮
- [ ] 点击重试按钮后重新发起请求
- [ ] 网络恢复后能正常加载模型配置

**实际结果**: _待测试_

**状态**: _待执行_

---

### ✅ TC9: 响应式布局测试（移动端）

**步骤**:
1. 打开浏览器开发者工具
2. 切换到移动设备模拟（如 iPhone 14 Pro）
3. 访问 ChatAnalysis 页面
4. 测试选择器在不同屏幕尺寸下的显示

**预期结果**:
- [ ] 选择器在移动端正常显示
- [ ] 选择器宽度适配屏幕宽度
- [ ] 选项文本在移动端清晰可读
- [ ] 触摸交互正常工作

**实际结果**: _待测试_

**状态**: _待执行_

---

### ✅ TC10: 对话中切换模型测试

**步骤**:
1. 访问 ChatAnalysis 页面
2. 发送一条消息，建立对话
3. 切换到另一个模型配置
4. 发送第二条消息
5. 检查历史消息是否受影响

**预期结果**:
- [ ] 切换模型不需要刷新页面
- [ ] 历史消息保持不变
- [ ] 新消息使用当前选中的模型（注：当前版本暂未实现后端集成，此功能为未来扩展点）

**实际结果**: _待测试_

**状态**: _待执行_

---

### ✅ TC11: 配置名称超长截断测试

**步骤**:
1. 创建一个名称超长的模型配置（超过 30 个字符）
2. 访问 ChatAnalysis 页面
3. 查看选择器中的选项显示
4. 鼠标悬停在选项上

**预期结果**:
- [ ] 超长名称被截断并显示省略号（...）
- [ ] 鼠标悬停时通过 title 属性显示完整名称
- [ ] 截断不影响选择功能

**实际结果**: _待测试_

**状态**: _待执行_

---

## 测试总结

### 通过的测试用例

_（测试完成后填写）_

### 失败的测试用例

_（测试完成后填写）_

### 发现的问题

_（测试完成后填写）_

### 建议和改进

_（测试完成后填写）_

---

## 测试签名

**测试人员**: ____________
**测试日期**: ____________
**测试环境**: ____________
